[Debug] [vite] connecting... (client, line 495)
[Debug] [vite] connected. (client, line 618)
[Log] ğŸš€ app.tsx loaded (app.tsx, line 22)
[Log] ğŸ” Office object: â€“ "Available" (app.tsx, line 23)
[Log] ğŸ” Document ready state: â€“ "interactive" (app.tsx, line 24)
[Log] ğŸ“Œ Office is defined, calling Office.onReady (app.tsx, line 35)
[Log] âœ… Office.onReady fired! â€“ {host: "Excel", platform: "Mac", addin: null} (app.tsx, line 37)
[Log] ğŸ“‹ Office info: â€“ "{â†µ  \"host\": \"Excel\",â†µ  \"platform\": \"Mac\",â†µ  \"addin\": nullâ†µ}" (app.tsx, line 38)
"{
  \"host\": \"Excel\",
  \"platform\": \"Mac\",
  \"addin\": null
}"
[Log] ğŸ¯ Root element: â€“  (app.tsx, line 41)
<div id="root">â€¦</div>

<div id="root">â€¦</div>
[Log] ğŸŒ³ React root created (app.tsx, line 47)
[Log] âœ… React render called (app.tsx, line 53)
[Log] ğŸ¨ MainApp rendering (app.tsx, line 26)
[Log] ğŸ¨ EnhancedChatInterfaceWrapper rendering with REFACTORED component (EnhancedChatInterfaceWrapper.tsx, line 19)
[Log] [ExcelService] Creating new instance (ExcelService.ts, line 28)
[Log] [ExcelService] Excel object is available (ExcelService.ts, line 32)
[Log] [12:29:20 PM] [INFO] Initiating SignalR connection... (RefactoredChatInterface.tsx, line 56)
[Log] ğŸ”Œ Creating SignalR connection to: https://localhost:7171/hub?access_token=dev-token-123 (SignalRClient.ts, line 19)
[Log] [12:29:20 PM] [INFO] Initializing selection change listener... (RefactoredChatInterface.tsx, line 56)
[Log] [12:29:20 PM] [INFO] Initializing context and mentions on load... (RefactoredChatInterface.tsx, line 56)
[Log] [12:29:20 PM] [SUCCESS] Selection change listener registered. (RefactoredChatInterface.tsx, line 56)
[Log] [Context] Merge detection currently disabled - using placeholder implementation (ExcelService.ts, line 384)
[Log] [12:29:20 PM] [INFO] Updating available mentions... (RefactoredChatInterface.tsx, line 56)
[Log] [Context] Merge detection currently disabled - using placeholder implementation (ExcelService.ts, line 384)
[Log] [12:29:20 PM] [INFO] Tracked user selection: Sheet1!A1 (RefactoredChatInterface.tsx, line 56)
[Info] [2025-07-24T16:29:20.992Z] Information: WebSocket connected to wss://localhost:7171/hub?access_token=dev-token-123&id=QEQXm-rsvYXNlF-bCZYB8A. (@microsoft_signalr.js, line 299)
[Info] [2025-07-24T16:29:20.992Z] Information: Using HubProtocol 'json'. (@microsoft_signalr.js, line 299)
[Log] âœ… SignalR connected successfully! (SignalRClient.ts, line 33)
[Log] âœ… Connection state: â€“ "Connected" (SignalRClient.ts, line 34)
[Log] [12:29:20 PM] [SUCCESS] SignalR connected successfully (RefactoredChatInterface.tsx, line 56)
[Log] ğŸ“¥ Received connected event: â€“ {connectionId: "AMVOXRZxhbzqSF-tU82d4A", timestamp: "2025-07-24T16:29:20.995787Z"} (SignalRClient.ts, line 67)
[Log] [12:29:20 PM] [INFO] SignalR raw message: {"type":"notification","data":{"connectionId":"AMVOXRZxhbzqSF-tU82d4A","timestamp":"2025-07-24T16:29:20.995787Z"}} (RefactoredChatInterface.tsx, line 56)
[Log] [info] [Message Handler] Received raw SignalR message â€“ {rawMessage: {type: "notification", data: {connectionId: "AMVOXRZxhbzqSF-tU82d4A", timestamp: "2025-07-24T16:29:20.995787Z"}}} (useMessageHandlers.ts, line 13)
[Log] [12:29:21 PM] [INFO] Backend connected. Connection ID: AMVOXRZxhbzqSF-tU82d4A (RefactoredChatInterface.tsx, line 56)
[Log] ğŸ” Authenticating after connection... (SignalRClient.ts, line 69)
[Log] ğŸ“¥ Received authSuccess: â€“ {sessionId: "session_638889713610028630", userId: "user_dev-token-123", timestamp: "2025-07-24T16:29:21.003667Z"} (SignalRClient.ts, line 75)
[Log] [12:29:21 PM] [SUCCESS] SignalR authenticated successfully. Session: session_638889713610028630 (RefactoredChatInterface.tsx, line 56)
[Log] [12:29:21 PM] [INFO] SignalR raw message: {"type":"auth_success","data":{"sessionId":"session_638889713610028630","userId":"user_dev-token-123","timestamp":"2025-07-24T16:29:21.003667Z"}} (RefactoredChatInterface.tsx, line 56)
[Log] [info] [Message Handler] Received raw SignalR message â€“ {rawMessage: {type: "auth_success", data: {sessionId: "session_638889713610028630", userId: "user_dev-token-123", timestamp: "2025-07-24T16:29:21.003667Z"}}} (useMessageHandlers.ts, line 13)
[Log] [12:29:21 PM] [SUCCESS] Authentication successful. Session ID: session_638889713610028630 (RefactoredChatInterface.tsx, line 56)
[Log] ğŸ” Authentication request sent (SignalRClient.ts, line 112)
[Log] ğŸŒŠ Starting streaming chat via SignalR (SignalRClient.ts, line 281)
[Log] [Stream] Chunk #1 received at 3665ms, length: 90 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 1, content length: 1 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #2 received at 3666ms, length: 118 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 15, content length: 15 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #3 received at 3679ms, length: 138 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 25, content length: 25 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #4 received at 3686ms, length: 134 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 23, content length: 23 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #5 received at 3697ms, length: 110 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 11, content length: 11 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #6 received at 3708ms, length: 110 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 11, content length: 11 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #7 received at 3719ms, length: 108 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 10, content length: 10 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #8 received at 3730ms, length: 110 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 11, content length: 11 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #9 received at 3741ms, length: 116 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 14, content length: 14 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #10 received at 3752ms, length: 160 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 36, content length: 36 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #11 received at 3763ms, length: 106 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 7, content length: 7 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #12 received at 3775ms, length: 104 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 8, content length: 8 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #13 received at 3786ms, length: 128 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 20, content length: 20 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #14 received at 3797ms, length: 138 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 25, content length: 25 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #15 received at 3808ms, length: 134 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 23, content length: 23 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #16 received at 3819ms, length: 118 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 15, content length: 15 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #17 received at 3830ms, length: 126 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: text, has delta: true, has content: true, delta length: 19, content length: 19 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #18 received at 3840ms, length: 191 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_start, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #19 received at 3851ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #20 received at 3861ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #21 received at 3871ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #22 received at 3882ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #23 received at 3893ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #24 received at 3904ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #25 received at 3915ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #26 received at 3926ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #27 received at 3936ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #28 received at 3947ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #29 received at 3958ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #30 received at 3969ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #31 received at 3981ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #32 received at 3991ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #33 received at 4002ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #34 received at 4012ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #35 received at 4022ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #36 received at 4034ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #37 received at 4045ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_progress, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #38 received at 4056ms, length: 194 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: tool_complete, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #39 received at 4067ms, length: 73 (useMessageHandlers.ts, line 520)
[Log] [Stream] Chunk type: undefined, has delta: false, has content: false, delta length: 0, content length: 0 (useMessageHandlers.ts, line 530)
[Log] [Stream] Chunk #40 received at 4079ms, length: 6 (useMessageHandlers.ts, line 520)
[Log] [Stream] Completed. Total chunks: 40, Duration: 4079ms (useMessageHandlers.ts, line 522)
[Log] [12:29:39 PM] [INFO] Streaming completed in 4094ms with 40 chunks (RefactoredChatInterface.tsx, line 56)
[Log] [12:29:39 PM] [INFO] Updating available mentions... (RefactoredChatInterface.tsx, line 56)
[Log] [Context] Merge detection currently disabled - using placeholder implementation (ExcelService.ts, line 384)
[Log] [12:29:39 PM] [INFO] Tracked user selection: Sheet1!A1 (RefactoredChatInterface.tsx, line 56)
[Log] ğŸ’“ Heartbeat sent (SignalRClient.ts, line 260)